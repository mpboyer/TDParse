\tikzset{
	a/.pic={%
			\path coordinate[dot, label=above:$\w{a}$] (a) + (0, 2) coordinate[label=above:$\e$] (bool) + (0, -1) coordinate (input)
			++ (-1, 1) coordinate (ctla) + (0, 1) coordinate[label=above:$\f{D}$] (effa);
			\node[anchor=north] at (input) {$\e \to \t$};
			\draw (input) -- (bool);
			\draw (a) to[out=180, in=-90] (ctla) -- (effa);
			\coordinate (-north) at (bool);
			\coordinate (-north east) at ($(bool) + (1, 0)$);
			\coordinate (-east) at ($(a) + (1, 0)$);
			\coordinate (-south east) at ($(input) + (1, 0)$);
			\begin{pgfonlayer}{background}
				\fill[catone] (input) rectangle ($(bool) + (1, 0)$);
				\fill[catmca] (input) rectangle ($(effa) + (-1, 0)$);
				\fill[catmc] (a) to [out=180, in=-90] (ctla) -- (effa) -- (bool) -- (a);
			\end{pgfonlayer}
		},
	cat/.pic={
			\path coordinate[dot, label=above:$\w{in\ a\ box}$] (box)
			+ (-1, 1) coordinate (ctlbox)
			+ (-1, 2) coordinate[label=above:$\f{D}$] (effbox)
			+ (0, -1) coordinate[label=below:$\bot$] (input)
			++ (0, 1) coordinate[label=above:$\w{cat} \land$, dot]
			+ (0, 1) coordinate[label=above:$\e\to \t$] (out);
			\draw[dashed] (input) -- (box);
			\draw (box) to[out=180, in=-90] (ctlbox) -- (effbox)
			(box) -- (out);
			\coordinate (-north) at (out);
			\coordinate (-north east) at ($(out) + (2, 0)$);
			\coordinate (-east) at ($(box) + (2, 0)$);
			\coordinate (-south east) at ($(input) + (2, 0)$);
			\begin{pgfonlayer}{background}
				\fill[catone] (input) rectangle ($(out) + (2, 0)$);
				\fill[catmca] (input) rectangle ($(effbox) + (-1, 0)$);
				\fill[catmc] (box) to[out=180, in=-90] (ctlbox) |- (out) -- (box);
			\end{pgfonlayer}
		},
	res/.pic={
			\path coordinate[dot, label=above:$\w{cat} \land$] (rcat)
			++ (0, 1) coordinate[dot, label=above:$\w{a}$] (ra)
			+ (0, 3) coordinate[label=above:$\e$] (rout)
			+ (-1, 1) coordinate[label=right:$\f{D}$] (rctla)
			++ (0, -2) coordinate[dot, label=above:$\w{in\ a\ box}$] (rbox)
			+ (0, -1) coordinate[label=below:$\bot$] (rbot)
			++ (-2, 2) coordinate (rctlb)
			++ (0, 1) coordinate[label=left:$\f{D}$] (rctlbb)
			++ (.5, 1) coordinate[dot, label=below:$\mu_{\f{D}}$] (rmu)
			+ (0, 1) coordinate[label=above:$\f{D}$] (reff);
			\draw[dashed] (rbot) -- (rbox);
			\draw (rout) -- (rbox)
			(rbox) to[out=180, in=-90] (rctlb)
			-- (rctlbb)
			to[out=90, in=180] (rmu)
			to[out=0, in=90] (rctla)
			to[out=-90, in=180] (ra)
			(rmu) -- (reff);
			\begin{pgfonlayer}{background}
				\fill[catone] (rbot) rectangle ($(rout) + (2, 0)$);
				\fill[catmca] (rbot) rectangle ($(reff) + (-1.5, 0)$);
				\fill[catmc] (rbox) to[out=180, in=-90] (rctlb) -- (ra) -- (rbox);
				\fill[catmc] (rctla) |- (ra) to[out=180, in=-90] (rctla);
				\fill[catmc] (rctla) rectangle (rctlb);
				\fill[catmc] (rctlbb) to[out=90, in=180] (rmu) |- (rctlbb);
				\fill[catmc] (rmu) to[out=0, in=90] (rctla) -| (rmu);
			\end{pgfonlayer}
		}
}
\rotatebox{90}{%
	\begin{tikzpicture}[yscale=.9]
		\pic[rotate=-90, transform shape] (nbox) at (0, 1) {a};
		\pic[rotate=-90, transform shape] (na) at ($(nbox-north) + (-2, 5)$) {cat};
		\node[rectangle, draw=black] (db) at ($(na-north) + (1, 0)$) {$\rotatebox{-90}{\f{D}(\e \to \t)}$};
		\node[rectangle, draw=black] (da) at ($(nbox-north) + (1, 0)$) {$\rotatebox{-90}{(\e \to \t) \to \f{D}\e}$};
		\node[rectangle, draw=black] (fmap) at ($(nbox-north) + (3, 0)$) {\rotatebox{-90}{$\combML_{\f{D}}$}};
		\path (fmap)
		+ (1, 1) coordinate[label=above:$\rotatebox{-90}{(\e \to \t) \to \f{D}\e}$] (ffu)
		+ (1, -1) coordinate[label=below:$\rotatebox{-90}{\e \to \t}$] (ffd)
		+ (7, 7) coordinate (tfm)
		++ (2, 0) node[rectangle, draw=black] (app) {$\rotatebox{-90}{>}$}
		+ (1, 0) coordinate[label=below:$\rotatebox{-90}{\f{D}\e}$] (fad)
		+ (5, 5) coordinate (tfd)
		++ (2, 0) node[rectangle, draw=black] (join) {\rotatebox{-90}{$\combJ_{\f{D}}$}}
		+ (4, 4) coordinate (tft)
		+ (7.5, 4) coordinate[label=right:$\rotatebox{-90}{\e}$] (end)
		;
		\begin{scope}
			\draw[postaction={on each segment={mid arrow={black}}}, thick, vulm]
			(da) to[out=0, in=240] (fmap)
			(db) to[out=0, in=120] (fmap)
			(fmap) to[out=60, in=180] (ffu)
			(fmap) to[out=-60, in=180] (ffd)
			(ffu) to[out=0, in=120] (app)
			(ffd) to[out=0, in=240] (app)
			(app) -- (join);
		\end{scope}
		%
		\node[circle, draw=black] (mu) at ($($(tfm)!0.5!(tfd)$) + (1, 0)$) {\rotatebox{-90}{$\mu_{\f{D}}$}};
		\coordinate[label=right:$\rotatebox{-90}{\f{D}}$] (ff) at ($(mu) + (3.5, 0)$);
		\draw[loosely dashed] (fmap) to[out=90, in=180]  (tfm)
		(app) to[out=90, in=180]  (tfd)
		(app) to [out=90, in=180] (tft)
		(tft) -- ($(tft) + (1, 0)$);
		\draw[loosely dashed]
		(tfm) to[out=0, in=90] node[pos=.5, above right] {$\rotatebox{-90}{\f{D}}$} (mu)
		(tfd) to[out=0, in=-90] node[pos=.5, below right] {$\rotatebox{-90}{\f{D}}$} (mu)
		(mu) -- ($(mu) + (1, 0)$);
		\draw[densely dotted, thick, postaction={on each segment={mid arrow=black}}] (join) to[out=90, in=180] (mu);
		\draw	($(tft) + (1, 0)$) -- (end) ($(mu) + (1, 0)$) -- (ff);
		%
		\node (imp) at ($(join) + (.5, 0)$) {$\Rightarrow$};
		\pic[rotate=-90, transform shape] (nres) at ($(imp.east) + (3,0)$) {res};
		\draw[->] let
		\p{end} = ($(end) + (1, 0)$),
		\p{bond} = ($(nbox-south east) + (0, -1.2)$),
		in (\x{bond}, \y{bond}) -- node[below] {\rotatebox{-180}{Direction of Reduction}} (\x{end}, \y{bond});
	\end{tikzpicture}
}
