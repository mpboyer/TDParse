\documentclass[math, english, info]{beamercours}
\makeatletter
\def\tikzimp@rt{1}
\makeatother

\bibliography{tdparse.bib}

\input{aux/preamble}
\DeclareFieldFormat{urldate}{}

\title{Effect-Driven Parsing}
\subtitle{Formal studies on a categorical approach to semantic parsing}
\institute{École Normale Supérieure | Yale University}
\author{Matthieu Boyer}
\date{\today}
\addlogo{~/DEV/latex/source/ens_psl.pdf}
\addlogo{~/Pictures/Yale_University_logo.svg.png}

\begin{document}
\fancytitleframe

\begin{frame}{Plan}
	\tableofcontents[subsectionstyle=hide,sectionstyle=show]
\end{frame}

\section{Introduction}
\subsection{General Introduction}
\begin{frame}
	\frametitle{Context}
	\begin{itemize}
		\item Given meanings for words, what is the meaning of a sentence?
		      \pause
		\item We provide a categorical type and effects system for
		      natural-language semantics parsing
		      (following \cite{bumfordEffectdrivenInterpretationFunctors2025}).
		\item We develop a graphical, type-driven parsing formalism that
		      derives sentence meaning compositionally from word meanings.
	\end{itemize}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Typed Semantics for Natural Languages}
	\begin{center}
		\setcellgapes{3pt}
		\makegapedcells
		\begin{NiceTabular}{>{\bf}LLL}
			Expression & \rm Type & \lambda\text{-Term} \\
			\word{planet}{\e\to\t}{\lambda x. \w{planet} x}{common nouns}
			\word{Jupiter}{\e}{{\bf j}\in \Var}{proper nouns}
			\word{chase}{\e \to \e \to \t}{\lambda o. \lambda s. \mathbf{chase}\left( o \right)\left( s \right)}{transitive verbs}
			\CodeAfter
			\begin{tikzpicture}
				\draw[double] (1|-2) -- (4|-2);
				\foreach \r in {4,6} {\draw (1|-\r) -- (4|-\r);}
			\end{tikzpicture}
		\end{NiceTabular}
	\end{center}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Syntactic Types and Semantic Types}
	\begin{itemize}
		\item Syntax \textbf{a cat} and \textbf{the cat} should have the same type: $\e$.
		      \pause
		\item No single canonical \textbf{cat} exists: that type cannot be $\e$.
	\end{itemize}
	\pause

	We will use \textbf{(side-)effects} to do the difference between them:
	\begin{equation*}
		\w{a\ cat} = \{c \mid \w{cat} c\} \tag{Set}
	\end{equation*}
	\begin{equation*}
		\w{the\ cat} = x \text{ if } \mathbf{cat}^{-1}(\top) = \{x\} \text{ else } \# \tag{Maybe}
	\end{equation*}
\end{frame}

\subsection{Categorical Introduction}
\begin{frame}
	\frametitle{Effects as Functors}
	Traditionally (\cite{moggiComputationalLambdacalculusMonads1989}), monads model side-effects.
	\pause

	Here, functors suffice and lighter structures are useful.
\end{frame}

\begin{frame}
	\frametitle{String Diagrams}
	String Diagrams are a formalism (\cite{hinzeIntroducingStringDiagrams2023})
	for visualising \textbf{multi-threaded} computations.

	\medskip

	Theoretically, they are the duals of diagrams in a $2$-category.

	\pause
	\medskip
	Used as a \textbf{tool for parsing} in \cite{coeckeMathematicalFoundationsCompositional2010}.
\end{frame}

\begin{frame}
	\frametitle{Other Categorical Theories}
	\cite{marcollimatildeetchomskynoametberwickrobertc.MathematicalStructureSyntactic}
	and \cite{senturiaAlgebraicStructureMorphosyntax2025} use Hopf algebras to
	give a model for parsing.

	\medskip

	\cite{melliesCategoricalContoursChomskySchutzenberger2025} use operads to
	prove results on CFGs.
\end{frame}

\section{Category-theoretical type system}
\subsection{Type system}
\begin{frame}
	\frametitle{Notations}
	\begin{itemize}
		\item We use a language $\mL$ of denotationally composed words.
		\item Start from a base typing CCC $\mC$ and effects (functors) $\mathcal{F}(\mL)$.
		      \pause
		\item Our typing CCC $\bar{\mC}$ is the closure of $\mC$ under $\mathcal{F}(\mL)^{*}$, products and exponentials.
	\end{itemize}
	Our types are all (effect-sequence, base type) combos, with functions/products.
\end{frame}

\begin{frame}[fragile]
	\frametitle{Intuitionistic-style Typing Judgements}
	\only<1>{
		\begin{align*}
			\frac{\cont x: \tau \poulpe \cont F \in \mathcal{F}(\mL)}{\cont Fx: F\tau }\fracnotate{Cons} \\[.25cm]
			\frac{\cont x: F\tau_{1} \poulpe \cont \phi: \tau_{1} \to \tau_{2}}{\cont \phi x: F\tau_{2} }\fracnotate{\texttt{fmap}}
		\end{align*}
	}
	\only<2>{
		\begin{align*}
			\frac{\cont x: \tau_{1} \poulpe \cont \phi: \tau_{1} \to \tau_{2}}{\cont \phi x: \tau_{2}}\fracnotate{App} \\[.25cm]
			\frac{\cont x: A\tau_{1} \poulpe \cont \phi: A\left( \tau_{1} \to \tau_{2} \right)}{\cont \phi x: A\tau_{2}}\fracnotate{\texttt{<*>}}
		\end{align*}
	}
	\only<3>{For natural transformations:
		\begin{align*}
			\frac{\cont x: \tau}{\cont x: A\tau}\fracnotate{\texttt{pure/return}} \\[.25cm]
			\frac{\cont x: MM\tau}{\cont x: M\tau}\fracnotate{\texttt{>>=}}
		\end{align*}
		\begin{align*}
			\forall F \overset{\theta}{\Longrightarrow} G,\poulpe \frac{\cont x: F\tau \poulpe \cont G: S' \subseteq \star \poulpe \tau \in S'}{\cont x : G\tau}\fracnotate{\texttt{nat}}
		\end{align*}
	}
\end{frame}

\subsection{Introducing a language}

\begin{frame}
	\frametitle{Presentation}
	To present a language in our formalism, we need:
	\begin{itemize}
		\item A syntax;
		\item A typed dictionary using effects;
		\item A typed lexicon of non-verbal constructs.
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Introducing Higher-Order Constructs}
	We implement higher-order semantics (e.g. the future and plural) via functors.

	\pause
	\smallskip

	We also enforce the notion of scope islands
	as in \cite{bumfordEffectdrivenInterpretationFunctors2025}:

	\begin{equation*}
		\w{if}: \left(\t \setminus \mF\left(\mL\right)^{*}\f{C}\t \right) \to \t \to \t
	\end{equation*}
\end{frame}

\begin{frame}
	\frametitle{Ambiguity}
	\resizebox{\textwidth}{!}{\input{aux/figures/parse-tree-ex.tex}}
\end{frame}

\section{Effect Handling}
\subsection{Notion and usage of handlers}
\begin{frame}
	\frametitle{Handlers}
	Handlers for an effect $F$ are natural transformations $F \Rightarrow \Id$ (\cite{wuEffectHandlersScope2014}) which invert units.

	\smallskip\pause

	\begin{enumerate}
		\item Language-Defined Handlers arise from fundamental properties of the considered effects.
		      \pause
		\item Speaker-dependant handlers which are dependent on the speaker.
	\end{enumerate}
\end{frame}

\subsection{String diagrams for effect handling}
\begin{frame}
	\frametitle{String Diagrams Representation of Sentences}
	String diagram are a representation of the side-effects and types of a
	sentence across its computation.
	\begin{center}
		\scalebox{.8}{\inputtikz{sd-thecatsleeps}}
	\end{center}

\end{frame}

\subsection{Reducing in string diagrams}
\begin{frame}
	\frametitle{Deformation of String Diagrams}
	\begin{thm}[Theorem 3.1 \cite{selingerSurveyGraphicalLanguages2010}, Theorem 1.2 \cite{joyalGeometryTensorCalculus1991}]
		\label{thm:isotopy}
		A well-formed equation between morphism terms in the language of monoidal
		categories follows from the axioms of monoidal categories if and only if it
		holds, up to planar isotopy, in the graphical language.
	\end{thm}
\end{frame}

\begin{frame}
	\frametitle{Equations on String Diagrams}
	Properties of monads, natural transformations, adjunctions
	and more can be explained in terms of commutative diagrams, but also as
	string diagram equations.

	Moreover, Theorem \ref{thm:isotopy} can be implemented as string diagram
	equations.
\end{frame}

\begin{frame}
	\frametitle{Confluence of Reductions}
	\begin{thm}[Confluence]
		The reduction system defined by the specified equations is confluent and
		therefore defines normal forms.\\
		Normalization is quadratic in the number of natural transformations.
	\end{thm}

	\smallskip

	This is accomplished using a formalism based on \cite{delpeuchNormalizationPlanarString2022}.
\end{frame}

\section{Semantic Parsing}
\subsection{The general method}
\begin{frame}
	\frametitle{Parsing Algorithm}
	Typing syntax trees is exponentially too long.

	\pause\medskip

	We use a Context-Free Grammar to model our typing system:
	each typing judgement is associated with a \textbf{combinator} describing the
	way to combine two phrases when parsing.

	\smallskip\pause

	This gives a complexity in $\O(\abs{\mF\left(\mL\right)}\abs{\mS}n^{3})$.
\end{frame}

\begin{frame}[allowframebreaks, fragile]
	\frametitle{Semantic Parse Trees}
	\begin{center}
		\includegraphics{aux/figures/parse-tree-2.pdf}
	\end{center}

	\centering
	\includegraphics{aux/figures/parse-tree-1.pdf}

	\begin{center}
		\includegraphics[height=.7\pageheight]{aux/figures/parse-tree-3.pdf}
	\end{center}
\end{frame}

\subsection{String diagrams for parsing}
\begin{frame}
	\frametitle{Combinators as String Diagrams}
	\includegraphics[width=\textwidth]{aux/figures/combinators-sd.pdf}
\end{frame}

\begin{frame}
	\frametitle{A Parsing Diagram Step}
	\centering
	\includegraphics[height=.8\textheight]{aux/figures/parsing-diagram.pdf}
\end{frame}

\begin{frame}
	\frametitle{Another Parsing Diagram Step}
	\centering
	\includegraphics[height=.8\textheight]{aux/figures/parsing-diagram2.pdf}
\end{frame}

\begin{frame}
	\frametitle{Building an Intuition}
	\centering
	\includegraphics[width=.7\textwidth]{aux/figures/knitting-example.jpeg}
\end{frame}

\begin{frame}
	\frametitle{A Full Parsing Diagram}
	\centering
	\includegraphics[height=.8\textheight]{aux/figures/3d-parsing-diagram.pdf}
\end{frame}

\subsection{String diagrams for reductions}
\begin{frame}
	\frametitle{Reducing the grammar}
	We translate equalities on actual denotations (from combinators or from the denotational system) into the reduction system on string diagrams.
	\smallskip

	Commutation of effects, Theorem \ref{thm:isotopy} and more, allow a reduction of the constant in the algorithmic complexity.
\end{frame}

\begin{frame}
	\frametitle{Conclusion}
	\begin{itemize}
		\item Theoretical enhancement of a type system for natural language semantics;
		      \pause
		\item No load added neither on the user (comprehension) nor the parser (efficiency).
	\end{itemize}
\end{frame}

\appendix

\questionsframe
\begin{frame}
	\frametitle{Lexicon}
	\centering
	\adjustbox{height=.4\textheight}{\input{aux/figures/lexicon-table.tex}}
\end{frame}

\begin{frame}
	\frametitle{Functor Denotations}
	\resizebox{\textwidth}{!}{\input{aux/figures/functors-table.tex}}
\end{frame}

\begin{frame}
	\frametitle{Plural Functor}
	\resizebox{\textwidth}{!}{\input{aux/figures/plural-table.tex}}
\end{frame}
\begin{frame}
	\frametitle{CFG of English}
	\centering
	\small
	\begin{minipage}{.45\textwidth}
		\setlength\tabcolsep{4pt}
		\begin{tabular}{>{\tt}l r >{\tt}l r}
			\firstrule{CP}{DP, VP}{}
			\grule{Cmp, CP}{}
			\grule{CP, CBar}{}
			\gskip
			\firstrule{CBar}{Cor, CP}{}
			\gskip
			\firstrule{Dbar}{Cor, DP}{}
			\gskip
			\firstrule{DP}{DP, Dbar}{}
			\grule{Dmp, DP}{}
			\grule{Det, NP}{}
			\grule{Gen, TN}{}
			\gskip
			\firstrule{Gen}{DP, GenD}{}
		\end{tabular}
	\end{minipage}
	\begin{minipage}{.45\textwidth}
		\setlength\tabcolsep{4pt}
		\begin{tabular}{>{\tt}l r >{\tt}l r}
			\firstrule{NP}{AdjP, NP}{}
			\grule{NP, AdjP}{}
			\gskip
			\firstrule{AdjP}{TAdj, DP}{}
			\grule{Deg, AdjP}{}
			\gskip
			\firstrule{VP}{TV, DP}{}
			\grule{AV, CP}{}
			\grule{VP, AdvP}{}
			\gskip
			\firstrule{TV}{DV, DP}{}
			\gskip
			\firstrule{AdvP}{TAdv, DP}{}
		\end{tabular}
	\end{minipage}

\end{frame}

\begin{frame}
	\frametitle{CFG for Parsing}
	\begin{minipage}{.9\textwidth}
		\begin{multicols}{2}
			\def\arraystretch{1.1}
			\begin{mgrammar}
				\firstrule{>, \beta}{\left(\alpha\to \beta\right), \alpha}{}
				\firstrule{<, \beta}{\alpha, \left(\alpha \to \beta\right)}{}
				\gskip
				\firstrule{\combJ_{\f{F}}\  \f{F}\tau}{\f{F}\f{F}\tau}{}
				\firstrule{\combDN_{\f{C}}\  \tau}{\f{C}_{\tau}\tau}{}
				\gskip
				\firstrule{\combML_{\f{F}} \left(\alpha, \beta\right)}{\f{F}\alpha, \beta}{}
				\firstrule{\combMR_{\f{F}} \left(\alpha, \beta\right)}{\alpha, \f{F}\beta}{}
			\end{mgrammar}

			\def\arraystretch{1.3}
			\begin{mgrammar}
				\firstrule{\combA_{\f{F}} \left(\alpha, \beta\right)}{\f{F}\alpha, \f{F}\beta}{}
				\firstrule{\combUR_{\f{F}} \left(\alpha \to \alpha', \beta\right)}{\f{F}\alpha\to \alpha', \beta}{}
				\firstrule{\combUL_{\f{F}} \left(\alpha, \beta\to \beta'\right)}{\alpha, \f{F}\beta \to \beta'}{}
				\firstrule{\combC_{\f{L}\f{R}} \left(\f{L} \alpha, \f{R}\beta\right)}{\left(\alpha, \beta\right)}{}
				\firstrule{\combER_{\f{R}} \left(\f{R}\left(\alpha \to \alpha'\right), \beta\right)}{\alpha\to \f{R}\alpha', \beta}{}
				\firstrule{\combEL_{\f{R}} \left(\alpha, \f{R}\left(\beta \to \beta'\right)\right)}{\alpha, \beta\to \f{R}\beta'}{}
			\end{mgrammar}
		\end{multicols}
	\end{minipage}

\end{frame}

\begin{frame}
	\frametitle{Combinator Denotations}
	\scriptsize
	\centering
	$	>                    = \lambda \phi. \lambda x. \phi x $\\[1.5ex]
	$ <                    = \lambda x. \lambda \phi. \phi x $\\[1.5ex]
	$ \combML_{\f{F}}      = \lambda M. \lambda x. \lambda y. (\fmap_{\f{F}} \lambda a. M(a, y)) x $\\[1.5ex]
	$ \combMR_{\f{F}}      = \lambda M. \lambda x. \lambda y. (\fmap_{\f{F}} \lambda b. M(x, b)) y $\\[1.5ex]
	$	\combA_{\f{F}}       = \lambda M. \lambda x. \lambda y. (\fmap_{\f{F}}\lambda a. \lambda b. M(a, b))(x) \texttt{<*>} y $\\[1.5ex]
	$	\combUL_{\f{F}}      = \lambda M. \lambda x. \lambda \phi. M(x, \lambda b. \phi(\eta_{\f{F}} b))$\\[1.5ex]
	$	\combUR_{\f{F}}      = \lambda M. \lambda \phi. \lambda y. M(\lambda a. \phi(\eta_{\f{F}} a),y) $\\[1.5ex]
	$ \combJ_{\f{F}}       = \lambda M. \lambda x. \lambda y. \mu_{\f{F}} M(x, y) $\\[1.5ex]
	$\combC_{\f{L}\f{R}}  = \lambda M. \lambda x. \lambda y. \epsilon_{\f{L}\f{R}}(\fmap_{\f{L}}(\lambda l. \fmap_{\f{R}}(\lambda r. M(l, r))(y)) (x))$\\[1.5ex]
	$	\combEL_{\f{R}}      = \lambda M. \lambda \phi. \lambda y. M(\Upsilon_{\f{R}} \phi, y)$\\[1.5ex]
	$	\combER_{\f{R}}      = \lambda M. \lambda x. \lambda \phi. M(x, \Upsilon_{\f{R}} \phi)$\\[1.5ex]
	$	\combDN_{\Downarrow} = \lambda M. \lambda x. \lambda y. \Downarrow M(x, y)$
\end{frame}

\begin{frame}[allowframebreaks]
	\frametitle{Bibliography}
	\printbibliography
\end{frame}

\end{document}

